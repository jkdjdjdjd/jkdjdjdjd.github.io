/* empty css             */import{a as me,E as ye}from"./form-item-BhbXf2Wd.js";/* empty css              */import{E as _e,a as ge}from"./select-BRSZvoY4.js";import{i as be}from"./popper-D7nATr0b.js";/* empty css               */import{a8 as he,D as ne,ac as Ce,R as Y,T as ke,a2 as le,I as j,o as A,c as $,b as e,y as N,n as M,m as a,t as w,d,w as r,v as J,ae as we,V as de,Z as Q,a0 as re,a1 as ue,ay as Ae,ad as ae,ah as Ie,az as Ee,r as f,aA as De,ap as Fe,J as X,a9 as Ve,x as W,Q as $e,aB as Se,aC as oe,aD as Te,H as Be,S as Le,N as Re,A as xe,aq as Pe,aE as qe,X as ze,Y as Me,aF as Oe,a6 as Ue,i as ee,_ as ie,aG as Ne,F as K,l as H,U as je,aH as Ke,q as Ge,a as Ze,g as h,e as He,p as Je,h as Xe}from"./index-ClR9mido.js";import{E as ce}from"./index-C-XKZ7yh.js";import{u as Ye,a as Qe,E as We,b as el,c as ll}from"./pay-YxoUbKbs.js";import{f as se,d as al,E as ol}from"./index-6DeqQRHY.js";import{F as sl,E as tl}from"./focus-trap-BVJif58M.js";import{U as ve}from"./typescript-C4g6lTyq.js";import{E as nl}from"./index-CprTcvBI.js";import"./castArray-CgGRmnE8.js";import"./isEqual-DaqQiu2f.js";import"./index-BCZ2JZN9.js";import"./strings-BKxQoeCT.js";import"./config-provider-KQkAXYMc.js";import"./scroll-Cpbtgqy5.js";import"./debounce-gG6lPOQr.js";import"./vnode-D1sms20D.js";const dl=(...l)=>m=>{l.forEach(I=>{he(I)?I(m):I.value=m})},fe=Symbol("dialogInjectionKey"),pe=ne({center:Boolean,alignCenter:Boolean,closeIcon:{type:Ce},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),rl={close:()=>!0},ul=["aria-level"],il=["aria-label"],cl=["id"],vl=Y({name:"ElDialogContent"}),fl=Y({...vl,props:pe,emits:rl,setup(l){const m=l,{t:I}=ke(),{Close:R}=Ae,{dialogRef:p,headerRef:C,bodyId:_,ns:t,style:c}=le(fe),{focusTrapRef:k}=le(sl),g=j(()=>[t.b(),t.is("fullscreen",m.fullscreen),t.is("draggable",m.draggable),t.is("align-center",m.alignCenter),{[t.m("center")]:m.center}]),i=dl(k,p),L=j(()=>m.draggable),E=j(()=>m.overflow);return Ye(p,C,L,E),(v,x)=>(A(),$("div",{ref:a(i),class:M(a(g)),style:re(a(c)),tabindex:"-1"},[e("header",{ref_key:"headerRef",ref:C,class:M([a(t).e("header"),{"show-close":v.showClose}])},[N(v.$slots,"header",{},()=>[e("span",{role:"heading","aria-level":v.ariaLevel,class:M(a(t).e("title"))},w(v.title),11,ul)]),v.showClose?(A(),$("button",{key:0,"aria-label":a(I)("el.dialog.close"),class:M(a(t).e("headerbtn")),type:"button",onClick:x[0]||(x[0]=n=>v.$emit("close"))},[d(a(de),{class:M(a(t).e("close"))},{default:r(()=>[(A(),J(we(v.closeIcon||a(R))))]),_:1},8,["class"])],10,il)):Q("v-if",!0)],2),e("div",{id:a(_),class:M(a(t).e("body"))},[N(v.$slots,"default")],10,cl),v.$slots.footer?(A(),$("footer",{key:0,class:M(a(t).e("footer"))},[N(v.$slots,"footer")],2)):Q("v-if",!0)],6))}});var pl=ue(fl,[["__file","dialog-content.vue"]]);const ml=ne({...pe,appendToBody:Boolean,appendTo:{type:ae(String),default:"body"},beforeClose:{type:ae(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:{type:Boolean,default:!1},headerAriaLevel:{type:String,default:"2"}}),yl={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[ve]:l=>Ie(l),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},_l=(l,m)=>{var I;const p=$e().emit,{nextZIndex:C}=Ee();let _="";const t=se(),c=se(),k=f(!1),g=f(!1),i=f(!1),L=f((I=l.zIndex)!=null?I:C());let E,v;const x=De("namespace",Se),n=j(()=>{const D={},q=`--${x.value}-dialog`;return l.fullscreen||(l.top&&(D[`${q}-margin-top`]=l.top),l.width&&(D[`${q}-width`]=Fe(l.width))),D}),y=j(()=>l.alignCenter?{display:"flex"}:{});function F(){p("opened")}function U(){p("closed"),p(ve,!1),l.destroyOnClose&&(i.value=!1)}function b(){p("close")}function s(){v==null||v(),E==null||E(),l.openDelay&&l.openDelay>0?{stop:E}=oe(()=>B(),l.openDelay):B()}function T(){E==null||E(),v==null||v(),l.closeDelay&&l.closeDelay>0?{stop:v}=oe(()=>u(),l.closeDelay):u()}function O(){function D(q){q||(g.value=!0,k.value=!1)}l.beforeClose?l.beforeClose(D):T()}function V(){l.closeOnClickModal&&O()}function B(){Te&&(k.value=!0)}function u(){k.value=!1}function P(){p("openAutoFocus")}function z(){p("closeAutoFocus")}function G(D){var q;((q=D.detail)==null?void 0:q.focusReason)==="pointer"&&D.preventDefault()}l.lockScroll&&Qe(k);function Z(){l.closeOnPressEscape&&O()}return X(()=>l.modelValue,D=>{D?(g.value=!1,s(),i.value=!0,L.value=be(l.zIndex)?C():L.value++,Ve(()=>{p("open"),m.value&&(m.value.scrollTop=0)})):k.value&&T()}),X(()=>l.fullscreen,D=>{m.value&&(D?(_=m.value.style.transform,m.value.style.transform=""):m.value.style.transform=_)}),W(()=>{l.modelValue&&(k.value=!0,i.value=!0,s())}),{afterEnter:F,afterLeave:U,beforeLeave:b,handleClose:O,onModalClick:V,close:T,doClose:u,onOpenAutoFocus:P,onCloseAutoFocus:z,onCloseRequested:Z,onFocusoutPrevented:G,titleId:t,bodyId:c,closed:g,style:n,overlayDialogStyle:y,rendered:i,visible:k,zIndex:L}},gl=["aria-label","aria-labelledby","aria-describedby"],bl=Y({name:"ElDialog",inheritAttrs:!1}),hl=Y({...bl,props:ml,emits:yl,setup(l,{expose:m}){const I=l,R=Be();al({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},j(()=>!!R.title));const p=Le("dialog"),C=f(),_=f(),t=f(),{visible:c,titleId:k,bodyId:g,style:i,overlayDialogStyle:L,rendered:E,zIndex:v,afterEnter:x,afterLeave:n,beforeLeave:y,handleClose:F,onModalClick:U,onOpenAutoFocus:b,onCloseAutoFocus:s,onCloseRequested:T,onFocusoutPrevented:O}=_l(I,C);Re(fe,{dialogRef:C,headerRef:_,bodyId:g,ns:p,rendered:E,style:i});const V=el(U),B=j(()=>I.draggable&&!I.fullscreen);return m({visible:c,dialogContentRef:t}),(u,P)=>(A(),J(Oe,{to:u.appendTo,disabled:u.appendTo!=="body"?!1:!u.appendToBody},[d(Me,{name:"dialog-fade",onAfterEnter:a(x),onAfterLeave:a(n),onBeforeLeave:a(y),persisted:""},{default:r(()=>[xe(d(a(We),{"custom-mask-event":"",mask:u.modal,"overlay-class":u.modalClass,"z-index":a(v)},{default:r(()=>[e("div",{role:"dialog","aria-modal":"true","aria-label":u.title||void 0,"aria-labelledby":u.title?void 0:a(k),"aria-describedby":a(g),class:M(`${a(p).namespace.value}-overlay-dialog`),style:re(a(L)),onClick:P[0]||(P[0]=(...z)=>a(V).onClick&&a(V).onClick(...z)),onMousedown:P[1]||(P[1]=(...z)=>a(V).onMousedown&&a(V).onMousedown(...z)),onMouseup:P[2]||(P[2]=(...z)=>a(V).onMouseup&&a(V).onMouseup(...z))},[d(a(tl),{loop:"",trapped:a(c),"focus-start-el":"container",onFocusAfterTrapped:a(b),onFocusAfterReleased:a(s),onFocusoutPrevented:a(O),onReleaseRequested:a(T)},{default:r(()=>[a(E)?(A(),J(pl,Pe({key:0,ref_key:"dialogContentRef",ref:t},u.$attrs,{center:u.center,"align-center":u.alignCenter,"close-icon":u.closeIcon,draggable:a(B),overflow:u.overflow,fullscreen:u.fullscreen,"show-close":u.showClose,title:u.title,"aria-level":u.headerAriaLevel,onClose:a(F)}),qe({header:r(()=>[u.$slots.title?N(u.$slots,"title",{key:1}):N(u.$slots,"header",{key:0,close:a(F),titleId:a(k),titleClass:a(p).e("title")})]),default:r(()=>[N(u.$slots,"default")]),_:2},[u.$slots.footer?{name:"footer",fn:r(()=>[N(u.$slots,"footer")])}:void 0]),1040,["center","align-center","close-icon","draggable","overflow","fullscreen","show-close","title","aria-level","onClose"])):Q("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,gl)]),_:3},8,["mask","overlay-class","z-index"]),[[ze,a(c)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["to","disabled"]))}});var Cl=ue(hl,[["__file","dialog.vue"]]);const kl=Ue(Cl),wl=()=>ee.get("/member/order/pre"),te=l=>ee.put(`/member/address/${l.id}`,l),Al=l=>ee.post("/member/address",l),Il={class:"address_container"},El=["onMousedown"],Dl={__name:"index",emits:["getAddress"],setup(l,{expose:m,emit:I}){const R=f(null),p=f(null),C=f([]),_=f(""),t=f(""),c=f(""),k=f(""),g=f([]),i=I,L=async()=>{const n=await Ke.get("https://yjy-oss-files.oss-cn-zhangjiakou.aliyuncs.com/tuxian/area.json");C.value=n.data,g.value=C.value.map(y=>({code:y.code,level:y.level,name:y.name}))},E=()=>{p.value.style.display="block"},v=()=>{_.value="",t.value="",c.value="",k.value="",g.value=C.value.map(n=>({code:n.code,level:n.level,name:n.name})),p.value.style.display="none"},x=n=>{if(n.level===0)t.value=n.code,_.value+=n.name+" ";else if(n.level===1)c.value=n.code,_.value+=n.name+" ";else if(n.level===2){if(k.value){const y=_.value.split(" ");y[y.length-1]=n.name,_.value=y.join(" "),k.value=n.code}else k.value=n.code,_.value+=n.name;i("getAddress",{provinceCode:t.value,cityCode:c.value,countyCode:k.value,fullLocation:_.value}),p.value.style.display="none"}};return X(t,n=>{n!==""&&(g.value=C.value.find(y=>y.code===n).areaList)}),X(c,n=>{if(n!==""){const y=C.value.find(F=>F.code===t.value).areaList;g.value=y.find(F=>F.code===n).areaList}}),m({clearAddress:v}),W(()=>{L()}),(n,y)=>{const F=de,U=ce;return A(),$("div",Il,[d(U,{ref_key:"areaIpt",ref:R,onFocus:E,onClick:E,onClear:v,onBlur:y[0]||(y[0]=b=>p.value.style.display="none"),modelValue:_.value,"onUpdate:modelValue":y[1]||(y[1]=b=>_.value=b),readonly:!0},{suffix:r(()=>[d(F,{class:"clear-icon",size:18,onClick:v},{default:r(()=>[d(a(Ne))]),_:1})]),_:1},8,["modelValue"]),e("div",{ref_key:"areaDom",ref:p,class:"area"},[e("ul",null,[(A(!0),$(K,null,H(g.value,b=>(A(),$("li",{onMousedown:je(s=>x(b),["stop","prevent"]),key:b.code},w(b.name),41,El))),128))])],512)])}}},Fl=ie(Dl,[["__scopeId","data-v-5a4968e1"]]),S=l=>(Je("data-v-68eec255"),l=l(),Xe(),l),Vl={class:"xtx-pay-checkout-page"},$l={class:"container"},Sl={class:"wrapper"},Tl=S(()=>e("h3",{class:"box-title"},"收货地址",-1)),Bl={class:"box-body"},Ll={class:"address"},Rl={class:"text"},xl={key:0,class:"none"},Pl={key:1},ql=S(()=>e("span",null,[h("收"),e("i"),h("货"),e("i"),h("人：")],-1)),zl=S(()=>e("span",null,"联系方式：",-1)),Ml=S(()=>e("span",null,"收货地址：",-1)),Ol={class:"action"},Ul=S(()=>e("h3",{class:"box-title"},"商品信息",-1)),Nl={class:"box-body"},jl={class:"goods"},Kl=S(()=>e("thead",null,[e("tr",null,[e("th",{width:"520"},"商品信息"),e("th",{width:"170"},"单价"),e("th",{width:"170"},"数量"),e("th",{width:"170"},"小计"),e("th",{width:"170"},"实付")])],-1)),Gl={href:"javascript:;",class:"info"},Zl=["src"],Hl={class:"right"},Jl=He('<h3 class="box-title" data-v-68eec255>配送时间</h3><div class="box-body" data-v-68eec255><a class="my-btn active" href="javascript:;" data-v-68eec255>不限送货时间：周一至周日</a><a class="my-btn" href="javascript:;" data-v-68eec255>工作日送货：周一至周五</a><a class="my-btn" href="javascript:;" data-v-68eec255>双休日、假日送货：周六至周日</a></div><h3 class="box-title" data-v-68eec255>支付方式</h3><div class="box-body" data-v-68eec255><a class="my-btn active" href="javascript:;" data-v-68eec255>在线支付</a><a class="my-btn" href="javascript:;" data-v-68eec255>货到付款</a><span style="color:#999;" data-v-68eec255>货到付款需付5元手续费</span></div><h3 class="box-title" data-v-68eec255>金额明细</h3>',5),Xl={class:"box-body"},Yl={class:"total"},Ql=S(()=>e("dt",null,"商品件数：",-1)),Wl=S(()=>e("dt",null,"商品总价：",-1)),ea=S(()=>e("dt",null,[h("运"),e("i"),h("费：")],-1)),la=S(()=>e("dt",null,"应付总额：",-1)),aa={class:"price"},oa={class:"submit"},sa={class:"addressWrapper"},ta=["onClick"],na=S(()=>e("span",null,[h("收"),e("i"),h("货"),e("i"),h("人：")],-1)),da=S(()=>e("span",null,"联系方式：",-1)),ra=S(()=>e("span",null,"收货地址：",-1)),ua={class:"dialog-footer"},ia=S(()=>e("span",{class:"line"},null,-1)),ca={class:"dialog-footer",style:{display:"flex","justify-content":"center"}},va={__name:"index",setup(l){const m=Ge(),I=Ze(),R=f(null),p=f(null),C=f(!1),_=f(!1),t=f({}),c=f({}),k=f([{value:0,label:"是"},{value:1,label:"否"}]),g=f({}),i=f({receiver:"",contact:"",provinceCode:"",cityCode:"",countyCode:"",address:"",postalCode:"",addressTags:"",isDefault:null,fullLocation:""}),L={receiver:[{required:!0,message:"请填写收件人",trigger:"blur"}],contact:[{required:!0,message:"请填写联系方式",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码",trigger:"blur"}],address:[{required:!0,message:"请填写详细地址",trigger:"blur"}],postalCode:[{required:!0,message:"请填写邮政编码",trigger:"blur"}],addressTags:[{required:!0,message:"请填写地址标签",trigger:"blur"}],isDefault:[{required:!0,message:"是否设置为默认地址",trigger:"blur"}]},E=async()=>{const b=await wl();t.value=b,c.value=b.userAddresses.find(s=>s.isDefault===0),g.value=c.value},v=b=>{g.value=b},x=async()=>{c.value.isDefault=1,await te(c.value),g.value.isDefault=0,await te(g.value),c.value=g.value,C.value=!1},n=b=>{for(let s in b)i.value[s]=b[s]},y=async()=>{await R.value.validate(),await Al(i.value),nl.success("添加地址成功"),F(),E()},F=()=>{_.value=!1,R.value.resetFields(),p.value.clearAddress()},U=async()=>{const b=await ll({deliveryTimeType:1,payType:1,payChannel:1,buyerMessage:"",goods:t.value.goods.map(s=>({skuId:s.skuId,count:s.count})),addressId:c.value.id});I.replace(`/rabbit/pay/${b.id}`),m.updateCartList()};return W(()=>{E()}),(b,s)=>{var G,Z,D,q;const T=ol,O=kl,V=ce,B=me,u=_e,P=ge,z=ye;return A(),$(K,null,[e("div",Vl,[e("div",$l,[e("div",Sl,[Tl,e("div",Bl,[e("div",Ll,[e("div",Rl,[c.value?(A(),$("ul",Pl,[e("li",null,[ql,h(w(c.value.receiver),1)]),e("li",null,[zl,h(w(c.value.contact),1)]),e("li",null,[Ml,h(w(c.value.fullLocation)+" "+w(c.value.address),1)])])):(A(),$("div",xl," 您需要先添加收货地址才可提交订单。 "))]),e("div",Ol,[d(T,{size:"large",onClick:s[0]||(s[0]=o=>C.value=!0)},{default:r(()=>[h("切换地址")]),_:1}),d(T,{size:"large",onClick:s[1]||(s[1]=o=>_.value=!0)},{default:r(()=>[h("添加地址")]),_:1})])])]),Ul,e("div",Nl,[e("table",jl,[Kl,e("tbody",null,[(A(!0),$(K,null,H(t.value.goods,o=>(A(),$("tr",{key:o.id},[e("td",null,[e("a",Gl,[e("img",{src:o.picture,alt:""},null,8,Zl),e("div",Hl,[e("p",null,w(o.name),1),e("p",null,w(o.attrsText),1)])])]),e("td",null,"¥"+w(o.price),1),e("td",null,w(o.count),1),e("td",null,"¥"+w(o.totalPrice),1),e("td",null,"¥"+w(o.totalPayPrice),1)]))),128))])])]),Jl,e("div",Xl,[e("div",Yl,[e("dl",null,[Ql,e("dd",null,w((G=t.value.summary)==null?void 0:G.goodsCount)+"件",1)]),e("dl",null,[Wl,e("dd",null,"¥"+w((Z=t.value.summary)==null?void 0:Z.totalPrice.toFixed(2)),1)]),e("dl",null,[ea,e("dd",null,"¥"+w((D=t.value.summary)==null?void 0:D.postFee.toFixed(2)),1)]),e("dl",null,[la,e("dd",aa,w((q=t.value.summary)==null?void 0:q.totalPayPrice.toFixed(2)),1)])])]),e("div",oa,[d(T,{onClick:U,type:"primary",size:"large"},{default:r(()=>[h("提交订单")]),_:1})])])])]),d(O,{modelValue:C.value,"onUpdate:modelValue":s[3]||(s[3]=o=>C.value=o),title:"切换收货地址",width:"30%",center:""},{footer:r(()=>[e("span",ua,[d(T,{onClick:s[2]||(s[2]=o=>C.value=!1)},{default:r(()=>[h("取消")]),_:1}),d(T,{type:"primary",onClick:x},{default:r(()=>[h("确定")]),_:1})])]),default:r(()=>[e("div",sa,[(A(!0),$(K,null,H(t.value.userAddresses,o=>(A(),$("div",{class:M(["text item",{active:o.id===g.value.id}]),key:o.id,onClick:fa=>v(o)},[e("ul",null,[e("li",null,[na,h(w(o.receiver),1)]),e("li",null,[da,h(w(o.contact),1)]),e("li",null,[ra,h(w(o.fullLocation+o.address),1)])])],10,ta))),128))])]),_:1},8,["modelValue"]),d(O,{onClose:F,modelValue:_.value,"onUpdate:modelValue":s[10]||(s[10]=o=>_.value=o),title:"添加收货地址",width:"30%",center:""},{footer:r(()=>[e("span",ca,[d(T,{onClick:F},{default:r(()=>[h("取消")]),_:1}),d(T,{type:"primary",onClick:y},{default:r(()=>[h("确定")]),_:1})])]),default:r(()=>[ia,d(z,{rules:L,ref_key:"addressRef",ref:R,model:i.value,size:"large","label-width":"120px"},{default:r(()=>[d(B,{required:"",label:"收货人姓名",prop:"receiver"},{default:r(()=>[d(V,{clearable:"",modelValue:i.value.receiver,"onUpdate:modelValue":s[4]||(s[4]=o=>i.value.receiver=o)},null,8,["modelValue"])]),_:1}),d(B,{required:"",label:"联系方式",prop:"contact"},{default:r(()=>[d(V,{clearable:"",modelValue:i.value.contact,"onUpdate:modelValue":s[5]||(s[5]=o=>i.value.contact=o)},null,8,["modelValue"])]),_:1}),d(B,{required:"",label:"所在地区"},{default:r(()=>[d(Fl,{ref_key:"addressChildRef",ref:p,onGetAddress:n},null,512)]),_:1}),d(B,{required:"",label:"详细地址",prop:"address"},{default:r(()=>[d(V,{modelValue:i.value.address,"onUpdate:modelValue":s[6]||(s[6]=o=>i.value.address=o),autosize:{minRows:2,maxRows:4},type:"textarea",clearable:""},null,8,["modelValue"])]),_:1}),d(B,{required:"",label:"邮政编码",prop:"postalCode"},{default:r(()=>[d(V,{clearable:"",modelValue:i.value.postalCode,"onUpdate:modelValue":s[7]||(s[7]=o=>i.value.postalCode=o)},null,8,["modelValue"])]),_:1}),d(B,{required:"",label:"地址标签",prop:"addressTags"},{default:r(()=>[d(V,{modelValue:i.value.addressTags,"onUpdate:modelValue":s[8]||(s[8]=o=>i.value.addressTags=o)},null,8,["modelValue"])]),_:1}),d(B,{required:"",label:"设为默认地址",prop:"isDefault"},{default:r(()=>[d(P,{modelValue:i.value.isDefault,"onUpdate:modelValue":s[9]||(s[9]=o=>i.value.isDefault=o),placeholder:"请选择"},{default:r(()=>[(A(!0),$(K,null,H(k.value,o=>(A(),J(u,{key:o,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}},Ra=ie(va,[["__scopeId","data-v-68eec255"]]);export{Ra as default};
